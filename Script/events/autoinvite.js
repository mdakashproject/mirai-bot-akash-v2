module.exports.config = {
  name: "autoinvite",
  eventType: ["log:unsubscribe"],
  version: "2.5",
  credits: "MOHAMMAD AKASH",
  description: "Auto re-add members who leave the group"
};

module.exports.run = async function({ api, event, Users }) {
  const { threadID, logMessageData, author } = event;
  const leftID = logMessageData.leftParticipantFbId;

  // тЬЕ ржпржжрж┐ ржЗржЙржЬрж╛рж░ ржирж┐ржЬрзЗ рж▓рж┐ржн ржирзЗрзЯ (kick ржирж╛ рж╣рзЯ)
  if (leftID === author) {
    const userInfo = await Users.getData(leftID);
    const userName = userInfo.name || "Unknown";

    // тЬЕ Bold ржлржирзНржЯ ржорзНржпрж╛ржк
    const boldMap = {
      A: "ЁЭЧФ", B: "ЁЭЧХ", C: "ЁЭЧЦ", D: "ЁЭЧЧ", E: "ЁЭЧШ", F: "ЁЭЧЩ", G: "ЁЭЧЪ", H: "ЁЭЧЫ", I: "ЁЭЧЬ", J: "ЁЭЧЭ",
      K: "ЁЭЧЮ", L: "ЁЭЧЯ", M: "ЁЭЧа", N: "ЁЭЧб", O: "ЁЭЧв", P: "ЁЭЧг", Q: "ЁЭЧд", R: "ЁЭЧе", S: "ЁЭЧж", T: "ЁЭЧз",
      U: "ЁЭЧи", V: "ЁЭЧй", W: "ЁЭЧк", X: "ЁЭЧл", Y: "ЁЭЧм", Z: "ЁЭЧн",
      a: "ЁЭЧо", b: "ЁЭЧп", c: "ЁЭЧ░", d: "ЁЭЧ▒", e: "ЁЭЧ▓", f: "ЁЭЧ│", g: "ЁЭЧ┤", h: "ЁЭЧ╡", i: "ЁЭЧ╢", j: "ЁЭЧ╖",
      k: "ЁЭЧ╕", l: "ЁЭЧ╣", m: "ЁЭЧ║", n: "ЁЭЧ╗", o: "ЁЭЧ╝", p: "ЁЭЧ╜", q: "ЁЭЧ╛", r: "ЁЭЧ┐", s: "ЁЭША", t: "ЁЭШБ",
      u: "ЁЭШВ", v: "ЁЭШГ", w: "ЁЭШД", x: "ЁЭШЕ", y: "ЁЭШЖ", z: "ЁЭШЗ"
    };

    const boldName = userName
      .split("")
      .map(c => boldMap[c] || c)
      .join("");

    // тЬЕ ржоржЬрж╛рж░ ржорзЗрж╕рзЗржЬ
    const msg = `ЁЯЫС ржПржЗ ржмрж▓ржж....!! ЁЯШ╣  
${boldName}  
ЁЯТм ржЧрзНрж░рзБржк ржерзЗржХрзЗ рж▓рж┐ржн ржирзЗржУрзЯрж╛ ржХрж┐ ржорзБржЦрзЗрж░ ржХржерж╛ ржирж╛ржХрж┐? ЁЯШП  
ЁЯСС ржпрзЗ ржЧрзНрж░рзБржкрзЗ ржЖржорж┐ ржерж╛ржХрж┐..?? ЁЯР╕  
тЪая╕П рж╕рзЗржЗ ржЧрзНрж░рзБржк ржерзЗржХрзЗ рж▓рж┐ржн ржирзЗржУрзЯрж╛ ржЕрж╕ржорзНржнржм ржнрж╛ржЗ! ЁЯШВ  
ЁЯМА ржЖржмрж╛рж░ ржЕрзНржпрж╛ржб ржХрж░рзЗ ржжрж┐рж▓рж╛ржо ЁЯШЗ  

тФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБ
ЁЭЧаЁЭЧвЁЭЧЫЁЭЧФЁЭЧаЁЭЧаЁЭЧФЁЭЧЧ ЁЭЧФЁЭЧЮЁЭЧФЁЭЧжЁЭЧЫ
тФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБ`;

    // тЬЕ ржЖржмрж╛рж░ ржЧрзНрж░рзБржкрзЗ ржЕрзНржпрж╛ржб ржХрж░рж╛
    try {
      await api.addUserToGroup(leftID, threadID);
      await api.sendMessage(msg, threadID);
    } catch (err) {
      api.sendMessage(
        "тЪая╕П ржжрзБржГржЦрж┐ржд, ржЖржорж┐ ржЗржЙржЬрж╛рж░ржЯрж╛ржХрзЗ ржЖржмрж╛рж░ ржЕрзНржпрж╛ржб ржХрж░рждрзЗ ржкрж╛рж░рж┐ржирж┐ред рж╕ржорзНржнржмржд ржЕрзНржпрж╛ржб ржмрзНрж▓ржХ ржХрж░рж╛ ржЖржЫрзЗред",
        threadID
      );
    }
  }
};
